<p data-nodeid="15036" class="">通过前面课时的学习和讨论，我想你对于测试开发工程师的技术等级划分，以及日常工作都已经有所了解了。</p>
<p data-nodeid="15037">那么，当你拿到你的第一个测试开发新手任务——测试框架开发之后，应该从何入手呢？</p>
<p data-nodeid="15038">俗话说“万丈高楼平地起”，对于测试框架来说，<strong data-nodeid="15149">最致命的问题就是，投入使用后才发现框架结构不清晰，设计不合理，从而导致测试框架不可扩展、无法迁移，</strong> 可见测试框架有多么重要。</p>
<p data-nodeid="15039">比如，我之前带过一个徒弟，他第一次写测试框架时，把本应该属于框架基础的查找待运行测试的功能放在了与业务耦合的 Page 类里，而且在查找文件的时候，其针对文件路径的处理又没有用操作系统分隔符，而是直接用的Windows 上的文件分隔符。</p>
<p data-nodeid="15040">当时我问了两个问题：</p>
<ul data-nodeid="15041">
<li data-nodeid="15042">
<p data-nodeid="15043">如果我们换一个项目，想要用你的框架，可以直接用吗？</p>
</li>
<li data-nodeid="15044">
<p data-nodeid="15045">我现在的测试要换到 Mac 系统上去做，你的框架还能正常运行吗？</p>
</li>
</ul>
<p data-nodeid="15046">很显然，他的第一次尝试不够成功，不过这也说明了测试框架的设计是有一定规律可循的。那么，有哪些规律需要遵守呢？不急，这事儿我放在下一讲和你说，这一讲我想先来跟你聊聊什么是测试框架，它有哪些构成，以及常见的类型有哪些，这些是你进入下一讲内容之前必须要掌握的知识。</p>
<h3 data-nodeid="15047">自动化测试框架的引入</h3>
<p data-nodeid="15048">我认为，测试框架好比工具箱，其作用是可以<strong data-nodeid="15161">便捷、高效</strong>地完成测试工作。而测试框架的引入，往往不是一蹴而就的，好的测试框架都是在实践中逐渐演化而来的。</p>
<p data-nodeid="15049">下面我讲一个不那么恰当但很形象的“猩猩吃甜点”的例子，向你讲解测试框架的引入流程，并以此说明测试框架的作用。</p>
<p data-nodeid="15050"><img src="https://s0.lgstatic.com/i/image/M00/4D/32/Ciqc1F9ZyfmAdk-6AAETgnqFtrY709.png" alt="2.png" data-nodeid="15165"></p>
<p data-nodeid="15051"><img src="https://s0.lgstatic.com/i/image/M00/4D/2F/Ciqc1F9ZxsuAbeA1AAQi68P0Ibk588.png" alt="1.png" data-nodeid="15168"></p>
<p data-nodeid="15052">“吃甜点”这件小事，从毫无章法，变成一件有流程、有仪式感、让人会感到幸福的事，“木条”在其中起了很重要的作用；同样地，让测试变得更加规范化、流程化、效率化，“测试框架”在其中也起了很大的作用。</p>
<p data-nodeid="15053">那么，测试框架有哪些构成呢？下面我来为你一一讲解。</p>
<h3 data-nodeid="15054">自动化测试框架的构成</h3>
<p data-nodeid="15055">一个成熟的测试框架主要由 4 部分组成：基础模块、管理模块、运行模块和统计模块，接下来我将逐一讲解。</p>
<h4 data-nodeid="15056">1. 基础模块</h4>
<p data-nodeid="15057">如果把自动化测试框架比作一辆汽车，那么自动化测试基础模块就是那四只轮胎，没有它们，这辆汽车寸步难行，它们一般包括如下部分。</p>
<ul data-nodeid="15058">
<li data-nodeid="15059">
<p data-nodeid="15060"><strong data-nodeid="15181">底层核心驱动库：</strong> 一般指用于操作被测试应用程序的第三方库，例如在 Web 端的 Selenium/WebDriver。</p>
</li>
<li data-nodeid="15061">
<p data-nodeid="15062"><strong data-nodeid="15186">可重用的组件：</strong> 一般用来降低开发成本，常见的有时间处理模块、登录模块等。</p>
</li>
<li data-nodeid="15063">
<p data-nodeid="15064"><strong data-nodeid="15191">对象库：</strong> 存储被测试对象的仓库。在实际应用中，常常将页面进行分组，把一个页面上的所有对象放到一个类里，也就是 Page Object 模式。</p>
</li>
<li data-nodeid="15065">
<p data-nodeid="15066"><strong data-nodeid="15204">配置文件：</strong> 包括测试环境的配置和应用程序的配置。<strong data-nodeid="15205">测试环境配置</strong>，指的是一个功能从开发代码完成到上线，往往要经过几个测试环境的测试，测试环境的配置能够减少环境切换成本；<strong data-nodeid="15206">应用程序配置</strong>，主要包括被测试程序的一些配置，利用配置文件，可以做到在不更改代码的情况下覆盖相同程序的不同程序配置。</p>
</li>
</ul>
<h4 data-nodeid="15067">2. 管理模块</h4>
<p data-nodeid="15068">自动化测试管理模块就好比汽车的内饰和外观，它对测试框架的使用操作体验有着直接影响，一般可分为测试数据管理和测试文件管理两部分。</p>
<ul data-nodeid="15069">
<li data-nodeid="15070">
<p data-nodeid="15071"><strong data-nodeid="15214">测试数据管理</strong></p>
</li>
</ul>
<p data-nodeid="15072">测试数据存放的文件是否跟测试用例强绑定，以及测试数据是否容易替换、是否和测试框架耦合等，这些都决定着测试框架的“内饰”好坏。</p>
<p data-nodeid="15073">测试数据，一般指测试用例用到的各种测试数据，它们是为了验证业务正确性而构造的，每一条测试用例一般对应着一组或多组测试数据，测试数据创建一般分为实时创建和事先创建。</p>
<p data-nodeid="15074"><strong data-nodeid="15221">实时创建，</strong> 是在测试代码运行时才生成的测试数据。其好处有：测试数据是和测试代码耦合的，测试人员不需要关心其创建过程和业务调用链，通常用在测试的公用功能上。例如，给用户绑定银行卡以方便后续支付等。而坏处则是如果调用链太长，耗时会比较久。</p>
<p data-nodeid="15075"><strong data-nodeid="15226">事先创建，</strong> 是指测试代码运行前就准备好数据文件。其好处是数据拿来即用，几乎不耗费时间，由于没有业务调用，所以这在一定程度上减少了调用失败的风险；坏处则是数据文件本身需要维护，以保持可用性和正确性。</p>
<p data-nodeid="15076">测试数据在测试中非常重要，它关系到你的测试是否有效，测试框架要做到对测试数据有效管理。</p>
<ul data-nodeid="15077">
<li data-nodeid="15078">
<p data-nodeid="15079"><strong data-nodeid="15231">测试文件管理</strong></p>
</li>
</ul>
<p data-nodeid="15080">测试文件管理就好比汽车的颜色和外观，决定着第一印象，所以测试框架的文件结构应该清晰有序、一目了然。</p>
<p data-nodeid="15081">比如，一个测试用例应该对应建立三个文件，分别是：Page 类文件（xxxPage，根据 PO 模型）、测试类文件（testxxxPage）和对象库文件（xxxPageYml）。</p>
<p data-nodeid="15082">这三个文件共同描述了一个完整的测试用例，当你看到一个 Page 类时，就应该做到它还有一个对应的测试类。</p>
<p data-nodeid="15083">测试文件的结构清晰有助于他人理解测试框架的设计思想，更有利于测试框架的维护和推广。</p>
<h4 data-nodeid="15084">3. 运行模块</h4>
<p data-nodeid="15085">自动化测试运行模块是测试框架的发动机，它主要用于测试用例的组织和运行，一般包括如下部分。</p>
<ul data-nodeid="15086">
<li data-nodeid="15087">
<p data-nodeid="15088"><strong data-nodeid="15244">测试用例调度，驱动机制。</strong> 测试框架应能按需组织，调度测试用例生成、执行。举例来说，测试框架可以在运行时根据使用者给定的 Tag 动态挑选要运行的测试用例，并把它们调度执行（可以顺序执行，也可以并发执行，还可以远程执行）。</p>
</li>
<li data-nodeid="15089">
<p data-nodeid="15090"><strong data-nodeid="15257">错误恢复机制。</strong> 由于测试环境、测试程序、测试代码存在各种不确定因素，测试框架应该具备一定的错误恢复机制。在测试用例执行中，引起错误的类型一般可分为<strong data-nodeid="15258">代码/运行导致的错误</strong>和<strong data-nodeid="15259">环境/依赖导致的错误</strong>，测试框架应该能够识别这两种错误并给予相应的处理。</p>
</li>
<li data-nodeid="15091">
<p data-nodeid="15092"><strong data-nodeid="15264">持续集成支持。</strong> 测试框架应该能够和 CI 系统低成本集成，包括通过用户输入参数指定运行环境、测试结束后自动生成测试报告等。</p>
</li>
</ul>
<h4 data-nodeid="15093">4. 统计模块</h4>
<p data-nodeid="15094">自动化测试统计模块，就相当于汽车的品质和口碑。好的统计模块，不仅能告诉你当前的测试有没有 Bug，还能分析软件质量随着时间的演变情况，这是测试框架的质量体现。</p>
<p data-nodeid="15095">自动化测试统计模块一般包括如下两部分：</p>
<ul data-nodeid="15096">
<li data-nodeid="15097">
<p data-nodeid="15098"><strong data-nodeid="15274">测试报告。</strong> 测试报告应该全面，包括测试用例条数统计、测试用例成功/失败百分比、测试用例总执行时间等总体信息。其中，对于单条测试用例，还应该包括测试用例 ID、测试用例运行结果、测试用例运行时间、测试用例所属模块、测试失败时刻系统截图、测试的日志等信息。</p>
</li>
<li data-nodeid="15099">
<p data-nodeid="15100"><strong data-nodeid="15279">日志模块。</strong> 测试框架应该包括完善的日志文件，方便出错时进行排查和定位。</p>
</li>
</ul>
<h3 data-nodeid="15101">常用的测试框架类型</h3>
<p data-nodeid="15102">测试框架有很多类型，比较常见的有以下四类。</p>
<h4 data-nodeid="15103">1. 模块化测试框架</h4>
<p data-nodeid="15104">模块化测试框架是利用 OOP 思想和 PO 模式改造而来的框架。</p>
<p data-nodeid="15105">模块化测试框架把整个测试分为多个模块，模块化有以下几个特征：</p>
<ul data-nodeid="15106">
<li data-nodeid="15107">
<p data-nodeid="15108">我们将一个业务或者一个页面成为一个 Page 对象；</p>
</li>
<li data-nodeid="15109">
<p data-nodeid="15110">这个 Page 对象，我们以一个 Page 类来表示它；</p>
</li>
<li data-nodeid="15111">
<p data-nodeid="15112">这个 Page 类里存放有所有这个 Page所属的页面对象、元素操作；</p>
</li>
<li data-nodeid="15113">
<p data-nodeid="15114">页面对象和元素操作组成一个个的测试类方法，供测试用例层调用。</p>
</li>
</ul>
<p data-nodeid="15115">简单来说，<strong data-nodeid="15296">使用了 PO 模式的框架就可以叫作模块化测试框架</strong>。</p>
<ul data-nodeid="15116">
<li data-nodeid="15117">
<p data-nodeid="15118">模块化测试框架的<strong data-nodeid="15302">好处</strong>在于方便维护，你的测试用例可以由不同模块的不同对象组成；</p>
</li>
<li data-nodeid="15119">
<p data-nodeid="15120"><strong data-nodeid="15307">坏处</strong>在于你需要非常了解你的系统及这些模块是如何划分的，才能在测试脚本里自如地使用，否则你就会陷入重复定义模块对象的循环里。</p>
</li>
</ul>
<h4 data-nodeid="15121">2. 数据驱动框架</h4>
<p data-nodeid="15122">数据驱动框架主要解决了<strong data-nodeid="15316">测试数据的</strong>问题。</p>
<p data-nodeid="15123">在测试中，我们常常需要为同一个测试逻辑，构造不同的测试数据以满足业务需求，这些测试数据可以保存在测试代码里，也可以保存在外部文件里（包括 Excel、File、DB）。</p>
<p data-nodeid="15124">数据驱动框架的<strong data-nodeid="15323">精髓</strong>在于，输入 M 组数据，框架会自动构造出 M 个测试用例，并在测试结果中把每一个测试用例的运行结果独立展示出来。</p>
<p data-nodeid="15125">在 Python 架构里，最出名的数据驱动框架就是 DDT。</p>
<blockquote data-nodeid="15126">
<p data-nodeid="15127">这个后续我会在第 11 和 12 课时的“DDT：博采众长，数据驱动的秘诀”详细介绍并实现。</p>
</blockquote>
<h4 data-nodeid="15128">3. 关键字驱动框架</h4>
<p data-nodeid="15129">关键字驱动其实就是把一系列代码操作封装成一个关键字（这个关键字其实是函数名），在测试里，可以通过使用组合关键字的方式来生成测试用例，而不去关心这个关键字是如何运作的。</p>
<p data-nodeid="15130">关键字的一个典型应用是将登录操作封装为关键字 Login，之后在后续代码里，有关 Login的操作，就仅需调用这个关键字 Login，而不必又重新进行一次登录操作。</p>
<p data-nodeid="15131">关键字在领域里的最佳应用典范我认为是<strong data-nodeid="15336">BDD</strong>（行为驱动开发），它甚至被当成一种独立的敏捷软件开发技术来使用。</p>
<h4 data-nodeid="15132">4. 混合模型</h4>
<p data-nodeid="15133">需要注意的是，没有任何规定要求你的测试框架要属于以上某种类型，因为测试框架的存在不是为了分类型，而是为了更好地测试。</p>
<p data-nodeid="15134">所以在工作中，我们常常需要糅合不同框架模型，我们将这种模式的测试框架称为混合模型。混合模型可以包含模块化框架，也可以使用数据驱动，或者使用 BDD 模式。</p>
<h3 data-nodeid="15135">小结</h3>
<p data-nodeid="15136">这一讲，我们讨论了自动化测试框架的一些基本概念和类型，就像大猩猩使用工具提升吃饭效率一样，测试框架的引入能大大提升测试效率；也讲解了自动化测试框架的基础组成部分，有助你在后续的框架设计中，更全面地评估你的测试框架水平；最后介绍了测试框架的类型，助于你辨别，融合不同的测试框架类型，设计出更合适的测试框架。</p>
<p data-nodeid="15137">为了便于你理解，我把本节的内容做了一个脑图，供你查阅。</p>
<p data-nodeid="15138"><img src="https://s0.lgstatic.com/i/image/M00/4D/35/CgqCHl9ZwXKAdvTmAAGKcfF0v8c323.png" alt="image (2).png" data-nodeid="15347"></p>
<p data-nodeid="15139">最后给你留个思考题：你认为，一个测试框架最具竞争力的地方，应该是哪个部分呢？欢迎你在下方留言区与大家分享讨论。</p>
<hr data-nodeid="15140">
<p data-nodeid="15352" class=""><a href="https://shenceyun.lagou.com/t/eka" data-nodeid="15355">“测试开发工程师名企直推营” 入口，免费领取 50G 资料包</a></p>

---

### 精选评论

##### **琴：
> 老师可以出门关于性能测试的课程吗🙏

 ###### &nbsp;&nbsp;&nbsp; 讲师回复：
> &nbsp;&nbsp;&nbsp; 可以哦，但还是得看大家的综合意愿情况，想开“性能测试”专栏的同学，可以给这个评论点赞哦，我看下有多少

##### **生：
> 最具竞争力的地方，我认为是框架的通用性

##### **4022：
> 一个测试框架最具竞争力的地方，应该是基础模块

 ###### &nbsp;&nbsp;&nbsp; 讲师回复：
> &nbsp;&nbsp;&nbsp; 大家说的都对，没有基础模块，测试框架就是空中楼阁，没有运行调度机制，测试框架就是没有油的汽车。我倒是觉得，测试框架最具竞争力的是各个模块组合后达到的整体效果。比如框架引用了， 手工测试减少了多少百分比？相同测试周期内，相比没有框架，节省了多少测试人力？出业务结果永远是公司的第一优先级。

##### **丹：
> 我觉得一个框架最核心的竞争力就是交代了他能做什么以及他不能做什么，知道了利弊才更好的帮助使用者决策

##### **旺：
> 测试框架运行模块

##### **1530：
> 什么时候更新

 ###### &nbsp;&nbsp;&nbsp; 编辑回复：
> &nbsp;&nbsp;&nbsp; 每周二、周四更新哦，每次更新一课时，敬请期待~

##### **佳：
> 比如selenium框架的核心就是webdriver。正是有了webdriver底层的操作，才让我们有了方法去进行自动化

##### **丹：
> 框架和使用场景的契合度吧

 ###### &nbsp;&nbsp;&nbsp; 讲师回复：
> &nbsp;&nbsp;&nbsp; 契合度也非常重要，比如在很轻量级的项目用很重的框架就不那么合适，反之亦然。

##### **钻：
> 最具有竞争力的地方，我认为是很够快速验证产品是否符合产品需求。

##### **5289：
> 老师能解释一下这句话吗？“Page 类文件（xxxPage，根据 PO 模型）、测试类文件（testxxxPage）和对象库文件（xxxPageYml）”这几种文件都是干什么的？

 ###### &nbsp;&nbsp;&nbsp; 讲师回复：
> &nbsp;&nbsp;&nbsp; 这几个文件用来分层，把测试代码，元素定位，元素操作分离开来。以达到代码重用的目的

##### **捷：
> 拉勾，缺了做笔记的功能

 ###### &nbsp;&nbsp;&nbsp; 编辑回复：
> &nbsp;&nbsp;&nbsp; 确实，我们会改进的，感谢同学的建议

##### **莹：
> 看到老师在其他提问里提到用例不能依赖其他的用例进行，不太明白对于有多环节的功能，某个节点功能实现是受前一个节点的策略影响，无法孤立验证，这种不是必然会有依赖吗？有想把每个环节模块化，但是这种关联性又不知道能否拆的这么顺利。

 ###### &nbsp;&nbsp;&nbsp; 讲师回复：
> &nbsp;&nbsp;&nbsp; 思考一下这种情况： ”如果你的测试用例是并发跑的，你测试用例之间如何保证有效的顺序依赖？” 
所以一个测试用例通常是原子性的，自隔离的。
像你说的这种有依赖的情况，通常情况下都会把可依赖的步骤用接口实现，然后在测试用例中直接调用。

##### **辉：
> 老师是否能分享一些框架源码

 ###### &nbsp;&nbsp;&nbsp; 讲师回复：
> &nbsp;&nbsp;&nbsp; 如果是pytest的源码，你可以安装pytest后在电脑上通过点击直接查看的。 如果是我文中介绍的自研的一些框架功能，我都会把源码贴在文章中的。
我希望大家自己跟着文章里的代码去敲，去理解里面的思路。这样专栏学下来，源码也有， 你也更有收获。

##### **国：
> 错误恢复机制：因为刚学不久，发现现在写的APP测试，当某个用例失败，就直接停止运行了；使用了pytest的重试配置，APP的界面又未处于这个用例开始执行的界面怎么办呢？

 ###### &nbsp;&nbsp;&nbsp; 讲师回复：
> &nbsp;&nbsp;&nbsp; 重试一般是重试整条测试用例，所以每一条测试用例必须自身不依赖其它测试用例运行。

##### *毅：
> 针对前面的在做补充，不以业务服务得框架都是耍流氓

##### *毅：
> 跨平台，框架在所有项目或者说特定项目可直接复用，可低成本与常用的ci，cd联动，调用方便(对于只会一点点代码的小白)

 ###### &nbsp;&nbsp;&nbsp; 讲师回复：
> &nbsp;&nbsp;&nbsp; 对的，框架要为业务服务。实际上测试也是为业务服务的，一切投入都要看业务产出。

##### **倩：
> 项目通用型+可扩展性

##### Steven：
> 可重用组件以及错误回复机制。这两个地方好坏最直接影响脚本的稳定性。

##### **5223：
> 快速开发出符合项目要求的用例

##### **1095：
> 测试框架中最重要的模块应该是测试框架运行模块，它就像汽车的发动机，是全局中最重要的部分。

##### *涛：
> 测试数据驱动

##### *雪：
> 通用，改造简单，易上手

##### *丹：
> 多久更新完呀

 ###### &nbsp;&nbsp;&nbsp; 编辑回复：
> &nbsp;&nbsp;&nbsp; 11月26日会更完

##### **泽：
> 核心竞争力在于，免费开源，模块化，丰富的底层，是安全的，支持多种主流编程语言编写使用。

 ###### &nbsp;&nbsp;&nbsp; 讲师回复：
> &nbsp;&nbsp;&nbsp; 测试框架最具竞争的地方，我统一回答了。技术要为业务结果负责，是我的唯一判断标准

##### *闯：
> 如何根据自己的项目去做选型框架呢

 ###### &nbsp;&nbsp;&nbsp; 讲师回复：
> &nbsp;&nbsp;&nbsp; 这个问题很好。个人认为可以从以下几个方面来考虑： 1. 开发技术栈。 2. 测试技术栈跟开发的匹配程度。3是做项目还是做产品。4.业界通用度

##### *彬：
> 老师讲得太好了，期待快点更新，大家一起进步🐸

##### *阳：
> 适用性或实用性

##### *军：
> 我认为一个自动化测试框架最具有竞争力的是运行模块中的测试用例调度驱动机制

##### **分：
> 我认为是测试框架运行模块，因为这个模块主要是让我们的用例跑起来，真正与我们业务挂钩的地方。

 ###### &nbsp;&nbsp;&nbsp; 讲师回复：
> &nbsp;&nbsp;&nbsp; 我很认同你从业务角度来考虑这个问题，任何技术方案，都要跟当前公司的技术架构融合并且要产生业务价值，否则再好的框架，都只能是自娱自乐的玩具而已。

