<p data-nodeid="3783" class="">你好，我是 DevOps 亮哥。上一讲我主要带你回顾了一下 DevOps 的发展历史。从这一讲开始，我们进入 DevOps 正题。按照端到端的顺序，讲解 DevOps 中的最佳实践如何在软件开发过程中发挥作用。所谓<strong data-nodeid="3868">端到端</strong>，是指从需求提出到需求被发布到生产环境交付给用户的整个过程，可以理解为软件开发的全生命周期。所谓<strong data-nodeid="3869">最佳实践</strong>，是指被业界广泛采用的、被证明有效的方式方法。这个系列课程会囊括软件开发过程的各个阶段，每一课时都会对应解决这一阶段的某个或某些问题，比如需求阶段如何对用户需求达成共识，开发阶段如何保证提交代码的质量，如何平衡技术债务和开发进度等等。</p>
<p data-nodeid="3784">今天这一讲主要介绍如何使用<strong data-nodeid="3875">影响地图</strong>这个工具来解决产品规划、里程碑规划和用户需求分析的问题，保证软件开发的大方向是正确的。</p>
<h3 data-nodeid="3785">为什么要进行产品规划？</h3>
<p data-nodeid="3786">首先，请你思考以下问题：</p>
<ol data-nodeid="3787">
<li data-nodeid="3788">
<p data-nodeid="3789">你所参与的软件产品开发中，有多少功能是用户真正需要的？</p>
</li>
<li data-nodeid="3790">
<p data-nodeid="3791">你所参与的项目，有没有做到一半就取消的功能和产品？</p>
</li>
</ol>
<p data-nodeid="3792">你可能会长舒一口气，这两种情况太多了。</p>
<p data-nodeid="3793">软件行业是一个成功率较低的行业。据 Standish Group 发布的 CHAOS Report 显示：截至 1994 年，在研究了 8000 多个软件开发项目后，只有 16% 的软件项目是成功，其他 84% 的项目不是失败了，就存在严重的问题。</p>
<p data-nodeid="3794">在十年后的 2004 年，当研究人员将项目样本增加到了 4 万个，发现这时软件项目的成功率提高到了 29%。为什么十年后软件开发的成功率会增加？其中一个原因就是<strong data-nodeid="3887">精益思想和敏捷软件开发方法的广泛采用</strong>。</p>
<p data-nodeid="3795">但根据 2015 年的报告，从 2011 年到2015年，软件项目的成功率并未再有大的提升，基本是在 30% 左右，可以参考下图：</p>
<p data-nodeid="3796"><img src="https://s0.lgstatic.com/i/image/M00/71/A7/Ciqc1F-_SiuATWRsAABHeTbtySk081.png" alt="Drawing 0.png" data-nodeid="3891"></p>

<p data-nodeid="3798">其中，在这些失败的软件项目中有 31.1% 在未完成之前就取消了。软件项目的失败最终付出了金钱和时间的代价，最重要的是失去的机会是一去不复还的，有些企业失去抢占市场的先机，因此而倒闭。</p>
<p data-nodeid="3799">“项目中途取消”“需求中途取消”“项目延期超支”等问题的出现，最主要的原因有以下两点：一点是“不了解用户真实需求”。在产品在开发阶段，不去调查用户需求，而是<strong data-nodeid="3902">想当然的自我设定用户需求，</strong> 最终导致所开发的软件和用户想要的不一致。另一点是对产品缺乏整体的认识和理解。<strong data-nodeid="3903">产品的规划没有重点</strong>，眉毛胡子一把抓，什么想都做，但最终什么都没做好，错失了产品投放市场的最佳机会。</p>
<p data-nodeid="3800">由此可以看出，挖掘用户的真实需求是多么重要。如果一开始没有按照用户的需求进行开发，终究会落得中途废弃的下场。</p>
<p data-nodeid="3801">因此，我们需要找到一种工具或方法，能够挖掘出用户最真实的需求，能够帮助我们对产品进行定义和里程碑规划，确保交付的软件和用户的需求一致，并且是用户最高优先级的需求。这个工具就是——<strong data-nodeid="3910">影响地图</strong>。</p>
<h3 data-nodeid="3802">什么是影响地图？</h3>
<p data-nodeid="3803">影响地图是一种<strong data-nodeid="3917">战略规划</strong>方面的技术。它通过清晰的假设、可视化的形式，建立产品功能与商业目标之间的关系，并最终做出更合理的里程碑规划。从而使得开发人员在构建产品和交付过程中避免迷失方向。</p>
<p data-nodeid="3804">影响地图通过回答<strong data-nodeid="3923">为什么（why）、谁（who）、怎样（how）、什么（what）</strong> 这四个问题来一步一步构建完成一个思维导图。该思维导图一般是由技术人员、业务人员及其他相关人员共同协作完成。最终的思维导图框架如下图所示：</p>
<p data-nodeid="3805"><img src="https://s0.lgstatic.com/i/image/M00/71/B3/CgqCHl-_SkuAEk8HAAEqE36UrjE434.png" alt="Devops02图片1.png" data-nodeid="3926"></p>
<p data-nodeid="3806">下面介绍下这四个问题的含义以及在影响地图中的作用：</p>
<h4 data-nodeid="3807">1. 为什么（why）？</h4>
<p data-nodeid="3808">开发过程中，我们首先要回答的问题就是：<strong data-nodeid="3950">我们为什么要做这件事？<strong data-nodeid="3948">或者</strong>我们为什么要开发这个功能？<strong data-nodeid="3949">问题的答案正是我们要达到的目标。设立清晰的目标听起来简单，但真正做起来非常不容易。有很多软件项目失败的原因就是</strong>目标不清晰</strong>。注意，这里的目标指的是<strong data-nodeid="3951">业务目标</strong>。我们要实现的目标一定是业务目标。这个目标要有明确作用：或者能够为企业带来利润、客户，或者能够为其降低成本。</p>
<p data-nodeid="3809">因此，目标的设定非常关键。切记<strong data-nodeid="3957">不可不切实际！</strong> 好的目标应该符合 SMART 原则：Specific（明确的），Measurable（可度量的），Action-oriented（面向行动的），Realistic（现实的），Timely（有时限的）。比如：3 个月新增用户 100 万或年底之前完成销售额 1000 万等。</p>
<h4 data-nodeid="3810">2. 谁（who）？</h4>
<p data-nodeid="3811">地图的中间已经放好了要实现的目标，那么接下来的第一层就是表明<strong data-nodeid="3966">实现这个目标和哪些人或角色有关系</strong>。这个关系可以是正面的，也可以是负面的。比如：谁能帮助实现这个目标？谁会阻碍实现这个目标？这里要尽可能把所有相关联的人列举出来。防止开发过程中突然出现的角色对开发过程造成影响。</p>
<p data-nodeid="3812">罗列出的角色可以分为<strong data-nodeid="3992">主要角色</strong>、<strong data-nodeid="3993">次要角色</strong>和<strong data-nodeid="3994">场外角色</strong>。<strong data-nodeid="3995">主要角色</strong>一般指软件的<strong data-nodeid="3996">最终用户</strong>；<strong data-nodeid="3997">次要角色</strong>一般指软件的提供者，可能会包含产品经理、开发人员、测试人员、运维人员等；场外角色一般指不直接参与的人员，比如高层管理者。</p>
<h4 data-nodeid="3813">3. 怎样（how）？</h4>
<p data-nodeid="3814">第一层列举了实现业务目标影响到的角色。第二层就要考虑这些角色是如何影响最终要实现的目标的？也就是说，考虑角色是如何<strong data-nodeid="4006">帮助或阻碍目标的实现</strong>？这里就要思考角色会有哪些行为变化。我们可以根据行为的影响大小，实现难易进行优先级地排列。从而根据影响地图的层次结构清晰地掌握是谁造成了这些影响，以及他们如何影响目标的实现？</p>
<p data-nodeid="3815">注意，这里的“影响”影响到的并不是具体的产品功能，而是角色行为的变化。是行为与之前相比的不同之处。比如：页面响应时间缩短 30%，而不是页面响应时间本身。页面响应时间在之前的功能中也有，只是实现时间较长。如果要实现 why 的目标，需要将响应时间缩短30%，这才体现出与之前的变化。</p>
<h4 data-nodeid="3816">4. 什么（what）？</h4>
<p data-nodeid="3817">回答完前面三个问题，就可以讨论<strong data-nodeid="4020">具体要做什么</strong>才能实现这个影响了。比如：是应该交付一个软件功能，还是组织一场线下活动？这一层就是我们的工作范围了。注意：这里罗列的内容并不是所有要交付的内容，而是交付内容的可选项。我们需要在这一层筛选出<strong data-nodeid="4021">有价值的部分</strong>，同时过滤掉没有明显价值的部分。有价值的部分就可以作为里程碑规划中的内容，也是我们应当优先完成的内容。比如：为页面数据添加缓存，减少计算逻辑的再次处理等。</p>
<p data-nodeid="3818">通过将<strong data-nodeid="4035">交付的内容</strong>，<strong data-nodeid="4036">内容产生的影响</strong>，<strong data-nodeid="4037">影响实现的目标</strong>串联起来，我们能清楚地知道做这件事情的前因后果。从而在实际开发过程中合理分配资源，不会产生范围蔓延的问题。下面我通过一个实际的例子来描述如何使用影响地图进行需求分析。</p>
<h3 data-nodeid="3819">使用影响地图进行需求分析实践</h3>
<p data-nodeid="3820">在工作中，有用户投诉说打开商品详情页特别慢，加载时间特别长。产品经理针对这个问题建了一个任务“商品详情页异步加载显示”并拖到了下一个迭代里。这种情况下，究竟要不要按产品经理说的去做？如果不做又有什么其他解决方法？下面，我使用“影响地图”来分析一下这个需求。</p>
<p data-nodeid="3821"><strong data-nodeid="4043">STEP 1：Why? 先确定任务目标。</strong></p>
<p data-nodeid="3822">在这个例子里，产品经理提出“商品详情页异步加载显示”的需求。透过现象看本质，产品经理的<strong data-nodeid="4053">最终目的</strong>并不是要把商品详情页改造成异步加载的方式，而是要<strong data-nodeid="4054">提高商品详情页的加载速度</strong>，异步加载只不过是实现这个目标的一种解决方案。因此，我们先定义好目标。</p>
<p data-nodeid="3823"><img src="https://s0.lgstatic.com/i/image/M00/71/A7/Ciqc1F-_SoCAOiIZAAAaLWHQY-8337.png" alt="Drawing 4.png" data-nodeid="4057"></p>
<p data-nodeid="3824"><strong data-nodeid="4061">STEP 2：Who？这个目标跟谁有关？</strong></p>
<p data-nodeid="3825">根据经验，页面加载缓慢的因素有很多种。例如，后台的接口慢、前端的代码加载策略有问题、系统的部署架构需要优化、服务器的配置需要升级、 采用 CDN 进行静态资源分发等。因此要实现这个目标，关联方就会涉及以上提到可能因素相关的所有人员：后端开发人员、前端开发人员、架构师、设备管理员还有在购买设备和 CDN 服务时需要审批的领导等。因此，我们将影响任务目标的角色放入影响地图，如下图所示：</p>
<p data-nodeid="3826"><img src="https://s0.lgstatic.com/i/image/M00/71/B3/CgqCHl-_SoiARYeQAABPeJUlBSw010.png" alt="Drawing 5.png" data-nodeid="4065"></p>
<p data-nodeid="3827"><strong data-nodeid="4069">STEP 3：How？每种角色是如何影响这个目标的？</strong></p>
<p data-nodeid="3828">为了达成目标，我们根据每种角色的职责和工作范围，思考他们用什么方式影响这个目标。比如：后台开发人员提高后端接口提高响应时间，前端开发人员进行前端代码优化，架构师优化系统部署架构，通过负载均衡分散访问压力；静态资源文件单独存放加快下载速度，设备管理员提升硬件性能，领导需要加快方案落地速度等。这里要考虑的是角色行为对<strong data-nodeid="4075">目前现状与改进后的差异</strong>。有些是从无到有，有些是提高，有些是减少......总之角色的行为要产生变化。这些变化要影响到目标的实现。如下图所示：</p>
<p data-nodeid="3829"><img src="https://s0.lgstatic.com/i/image/M00/71/A7/Ciqc1F-_So6AA6HHAABQ39IadgE741.png" alt="Drawing 6.png" data-nodeid="4078"></p>
<p data-nodeid="3830"><strong data-nodeid="4082">STEP 4：What？具体做什么？</strong></p>
<p data-nodeid="3831">这一步要求我们针对上面每种角色不同的影响，罗列<strong data-nodeid="4088">具体的操作内容</strong>。也就是说，我要做什么事情才能产生上面这个影响。后台开发人员想要提高后端接口响应速度，可以通过添加分布式缓存、数据库添加索引、数据库读写分离等方式解决。前端开发人员想要优化前端代码，可以通过添加浏览器缓存、采用懒加载方式和采用 CDN 访问静态资源等方式解决。架构师想要优化服务器部署结构，可以通过改单点部署为集群部署，用负载均衡服务器分担单节点压力等方式解决。设备管理员想要提升硬件设备性能，可以通过购买高性能服务器和更换万兆光纤等方式解决。领导想要加快方案落地速度，可以通过及时审批（审查？）审批流程等方式解决。这些就是我们每个迭代需要的具体任务，在迭代结束时应该提供的交付物。如下图所示。</p>
<p data-nodeid="3832"><img src="https://s0.lgstatic.com/i/image/M00/71/B3/CgqCHl-_SpaAJbKvAACAHLYswZQ388.png" alt="Drawing 7.png" data-nodeid="4091"></p>
<p data-nodeid="3833"><strong data-nodeid="4095">STEP 5：选择最短路径。</strong></p>
<p data-nodeid="3834">通过上面 4 个步骤，我们形成了一份可供选择的任务清单。接下来我们应该做的并不是完成所有的任务，而是选择其中<strong data-nodeid="4109">成本低、效果好</strong>的完成。这里需要我们预估每个交付物的<strong data-nodeid="4110">效果</strong>和<strong data-nodeid="4111">成本</strong>。如下图所示，我们可以看出效果较好，成本低的交付物有：添加分布式缓存、数据库添加索引、添加浏览器缓存和采用懒加载的方式等。选择这些路径完成，将为我们减轻不少负担。</p>
<p data-nodeid="3835"><img src="https://s0.lgstatic.com/i/image/M00/71/A8/Ciqc1F-_SpyALmgtAADyHJ5hx-g488.png" alt="Drawing 8.png" data-nodeid="4114"></p>
<p data-nodeid="3836"><strong data-nodeid="4118">STEP 6：里程碑规划。</strong></p>
<p data-nodeid="3837">上一个步骤中选择的最短路径，可以作为第一个里程碑中需要交付的内容。如下图所示，标记为 ① 的任务是需要加入里程碑规划里的任务。待该里程碑完成后，我们要根据度量指标衡量目标达成的效果，再从剩余的选项中继续选择成本低、效果好的任务添加到下一个里程碑规划中，直到目标达成。</p>
<p data-nodeid="3838"><img src="https://s0.lgstatic.com/i/image/M00/71/B3/CgqCHl-_SqKAJ4Z9AACzw-AbugM039.png" alt="Drawing 9.png" data-nodeid="4122"></p>
<p data-nodeid="3839">到此，我们利用影响地图对产品经理提出的需求进行了分析和里程碑规划。从而确定了需求目标、具体工作内容和里程碑规划。上面这几个图有几个特点：</p>
<ul data-nodeid="3840">
<li data-nodeid="3841">
<p data-nodeid="3842">结构化。</p>
</li>
</ul>
<p data-nodeid="3843">影响地图是<strong data-nodeid="4130">结构化</strong>的。它的第一层是目标；第二层是影响哪些用户或角色能够实现这个目标，即角色；第三层是这些角色通过什么影响来帮助实现这个目标，即影响；第四层是通过什么具体的功能或事项来实现这个影响，即交付物。层层细化，非常清晰。</p>
<ul data-nodeid="3844">
<li data-nodeid="3845">
<p data-nodeid="3846">整体性。</p>
</li>
</ul>
<p data-nodeid="3847">影响地图是从目标到角色，到影响，再到交付物的树状视图。也是一个为产品开发，功能迭代中各相关角色提供的一个共享的、整体的视图。每个角色都能按照这个整体视图的脉络，理清自己的思路和职责，确保交付的功能能够帮助目标的达成。</p>
<ul data-nodeid="3848">
<li data-nodeid="3849">
<p data-nodeid="3850">协作性。</p>
</li>
</ul>
<p data-nodeid="3851">影响地图是各个角色沟通和协助的桥梁。各相关角色可以基于这张图来制定产品规划，里程碑规划。相比于过去基于“产品功能列表”的里程碑规划，基于影响地图的里程碑规划可以按照从交付物到目标的最短路径方法进行规划。这样制定出的规划更符合实际需求、更有效。</p>
<ul data-nodeid="3852">
<li data-nodeid="3853">
<p data-nodeid="3854">动态性。</p>
</li>
</ul>
<p data-nodeid="3855">这个图是需要不断迭代更新、不断完善的。因为基于影响地图的产品规划和需求分析，都是以假设为前提条件进行的，各一是假设最终的交付物能够产生各角色然后期望的影响，二是假设期望的影响能够达成最初定义的目标。这些假设是需要在迭代过程中进行验证的，然后我们也要根据验证的结果调整后续的里程碑规划。</p>
<h3 data-nodeid="3856">总结</h3>
<p data-nodeid="3857">就像我在本课时开头提到的那样。大多数软件项目之所以失败，是因为在软件开发过程中投入太多精力关注软件功能本身，反而忽略了需要交付的业务目标。产品经理在进行产品规划、里程碑规划和任务分配时，只是给出“做什么”和“怎么做”，很少去解释“为什么”。这样，在不了解目标的情况下，开发工作就像一只没有方向的船在大海上航行一样，虽然一直在航行，却难以到达目的地。</p>
<p data-nodeid="3858" class="">这时候，影响地图这一个工具就成了大船航行的方向和航海图。它可以辅助确定业务目标，将具体的工作任务与目标相关联，在制定里程碑规划时始终考虑目标，并通过最短路径快速实现业务目标。这些对于一个产品，甚至是一个企业都是至关重要的，感兴趣的小伙伴可以在工作中尝试一下。</p>

---

### 精选评论

##### **边来了个喇嘛：
> 四个W倒是很形象很好用

##### *青：
> 很实用，get

 ###### &nbsp;&nbsp;&nbsp; 编辑回复：
> &nbsp;&nbsp;&nbsp; 实用就请加油学吧~

##### **文：
> 这个技能和思维地图分析方法很不错，谢谢老师

##### **3917：
> 影响地图——一个很好的分析方法论

##### **华：
> 大佬

##### *亮：
> 逐步深入

##### **用户1280：
> 明天继续

##### *策：
> 这个技能get到了

##### **伟：
> 架构很清晰，理清很多流程，持续学习中。。。

##### *标：
> 不错

##### Sphinx：
> 在这之前以为自己曾经推过DevOps, 现在看来仅仅是CI/CD罢了，说起来还是没有从更全局的角度考虑问题，学习了

 ###### &nbsp;&nbsp;&nbsp; 编辑回复：
> &nbsp;&nbsp;&nbsp; 加油

##### *帆：
> 感觉非常好

##### **军：
> 请问老师：第五步，选择最短路径过程中，效果百分比是怎么评估的？

 ###### &nbsp;&nbsp;&nbsp; 讲师回复：
> &nbsp;&nbsp;&nbsp; 这个基本上就通过预估的方式了，可以让团队中各领域专家一起商定。

##### **5049：
> 先打个卡，明天再来继续消化。

##### *杰：
> 很棒，学到了

